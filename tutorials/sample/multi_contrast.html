
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Analysis of multiple isotopic contrasts &#8212; EasyReflectometry  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=c73c0f3e"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/sample/multi_contrast';</script>
    <link rel="canonical" href="https://docs.easyreflectometry.org/tutorials/sample/multi_contrast.html" />
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Resolution functions" href="resolution_functions.html" />
    <link rel="prev" title="Investigation of a surfactant monolayer" href="monolayer.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.2.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="EasyReflectometry  documentation - Home"/>
    <img src="../../_static/logo.png" class="logo__image only-dark pst-js-only" alt="EasyReflectometry  documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../sample/sample.html">Sample</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sample/material_library.html">Materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sample/layer_library.html">Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sample/assemblies_library.html">Assemblies</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../calculators.html">Calculators &amp; Optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../experiment/experiment.html">Experiment</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../tutorials.html">Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../fitting/simple_fitting.html">Fitting a simple slab model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fitting/repeating.html">A multilayer fitting model</a></li>
<li class="toctree-l2"><a class="reference internal" href="material_solvated.html">Using the MaterialSolvated</a></li>
<li class="toctree-l2"><a class="reference internal" href="monolayer.html">Investigation of a surfactant monolayer</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Analysis of multiple isotopic contrasts</a></li>
<li class="toctree-l2"><a class="reference internal" href="resolution_functions.html">Resolution functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../magnetism.html">Magnetism</a></li>

</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Credits</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/api.html">API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/assemblies/multilayer.html"><code class="docutils literal notranslate"><span class="pre">Multilayer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/assemblies/repeating_multilayer.html"><code class="docutils literal notranslate"><span class="pre">RepeatingMultilayer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/assemblies/surfactant_layer.html"><code class="docutils literal notranslate"><span class="pre">SurfactantLayer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/assemblies/gradient_layer.html"><code class="docutils literal notranslate"><span class="pre">GradientLayer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/elements/layer.html"><code class="docutils literal notranslate"><span class="pre">Layer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/elements/layer_area_per_molecule.html"><code class="docutils literal notranslate"><span class="pre">LayerAreaPerMolecule</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/elements/material.html"><code class="docutils literal notranslate"><span class="pre">Material</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/elements/material_density.html"><code class="docutils literal notranslate"><span class="pre">MaterialDensity</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/elements/material_mixture.html"><code class="docutils literal notranslate"><span class="pre">MaterialMixture</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/elements/material_solvated.html"><code class="docutils literal notranslate"><span class="pre">MaterialSolvated</span></code></a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/tutorials/sample/multi_contrast.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Analysis of multiple isotopic contrasts</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Reading-in-the-experimental-data">Reading in the experimental data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Building-our-models">Building our models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Introducing-constraints">Introducing constraints</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Setting-varying-parameters">Setting varying parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Creating-interfaces-and-performing-the-fitting">Creating interfaces and performing the fitting</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Analysis-of-multiple-isotopic-contrasts">
<h1>Analysis of multiple isotopic contrasts<a class="headerlink" href="#Analysis-of-multiple-isotopic-contrasts" title="Link to this heading">#</a></h1>
<p>In the use of neutron reflectometry, it is common to use multiple isotopic contrasts of experimental data to analyse a system in a constrained fashion. That is to say, that we have data from multiple different species (where isotopic substitution has been used to produce data with different scattering length density) that share the same structure. In this tutorial we will look at how <code class="docutils literal notranslate"><span class="pre">easyreflectometry</span></code> can be used to fit multiple contrasts of data from a <a class="reference internal" href="monolayer.html"><span class="doc">surfactant
monolayer</span></a> system, if you haven’t looked at the tutorial for a single contrast of surfactant monolayer data it is suggested that you as this tutorial will build on it.</p>
<p>First configure matplotlib to place figures in notebook and import needed modules</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">refnx</span>
<span class="kn">import</span> <span class="nn">pooch</span>

<span class="kn">import</span> <span class="nn">easyreflectometry</span>

<span class="kn">from</span> <span class="nn">easyreflectometry.data</span> <span class="kn">import</span> <span class="n">load</span>
<span class="kn">from</span> <span class="nn">easyreflectometry.plot</span> <span class="kn">import</span> <span class="n">plot</span>
<span class="kn">from</span> <span class="nn">easyreflectometry.sample</span> <span class="kn">import</span> <span class="n">Material</span>
<span class="kn">from</span> <span class="nn">easyreflectometry.sample</span> <span class="kn">import</span> <span class="n">SurfactantLayer</span>
<span class="kn">from</span> <span class="nn">easyreflectometry.sample</span> <span class="kn">import</span> <span class="n">Layer</span>
<span class="kn">from</span> <span class="nn">easyreflectometry.sample</span> <span class="kn">import</span> <span class="n">Multilayer</span>
<span class="kn">from</span> <span class="nn">easyreflectometry.sample</span> <span class="kn">import</span> <span class="n">LayerAreaPerMolecule</span>
<span class="kn">from</span> <span class="nn">easyreflectometry.sample</span> <span class="kn">import</span> <span class="n">Sample</span>
<span class="kn">from</span> <span class="nn">easyreflectometry.model</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">easyreflectometry.model</span> <span class="kn">import</span> <span class="n">PercentageFhwm</span>
<span class="kn">from</span> <span class="nn">easyreflectometry.calculators</span> <span class="kn">import</span> <span class="n">CalculatorFactory</span>
<span class="kn">from</span> <span class="nn">easyreflectometry.fitting</span> <span class="kn">import</span> <span class="n">Fitter</span>
<span class="kn">from</span> <span class="nn">easyscience.fitting</span> <span class="kn">import</span> <span class="n">AvailableMinimizers</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;easyreflectometry: </span><span class="si">{</span><span class="n">easyreflectometry</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;refnx: </span><span class="si">{</span><span class="n">refnx</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Reading-in-the-experimental-data">
<h2>Reading in the experimental data<a class="headerlink" href="#Reading-in-the-experimental-data" title="Link to this heading">#</a></h2>
<p>We load in three different isotopic contrast that are stored in a single <code class="docutils literal notranslate"><span class="pre">.ort</span></code> file. This <code class="docutils literal notranslate"><span class="pre">.ort</span></code> file uses the <a class="reference external" href="https://github.com/reflectivity/file_format/blob/master/specification.md#multiple-data-sets">mutliple data set syntax</a> to indicate that different measurements are present in a single file. We use <code class="docutils literal notranslate"><span class="pre">pooch</span></code> to fetch the file from the repository.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_path</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="c1"># URL to one of Pooch&#39;s test files</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://raw.githubusercontent.com/EasyScience/EasyReflectometryLib/master/docs/src/tutorials/sample/multiple.ort&quot;</span><span class="p">,</span>
    <span class="n">known_hash</span><span class="o">=</span><span class="s2">&quot;241bcb819cdae47fbbb310a99c2456c7332312719496b936a153dc7dee83e62c&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can plot the data and return the dimensions of the data to see the contrasts that are present.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dims</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Building-our-models">
<h2>Building our models<a class="headerlink" href="#Building-our-models" title="Link to this heading">#</a></h2>
<p>It can be seen above that there are three isotopic contrasts present in the <code class="docutils literal notranslate"><span class="pre">'multiple.ort'</span></code> file, namely: - <code class="docutils literal notranslate"><span class="pre">'d13DSPC-D2O'</span></code> - <code class="docutils literal notranslate"><span class="pre">'d70DSPC-D2O'</span></code> - <code class="docutils literal notranslate"><span class="pre">'d83DSPC-ACMW'</span></code></p>
<p>where, <code class="docutils literal notranslate"><span class="pre">'d13'</span></code> indicates that it is the head layer that is deuterated, <code class="docutils literal notranslate"><span class="pre">'d70'</span></code> indicates that the tail is deuterated and <code class="docutils literal notranslate"><span class="pre">'d83'</span></code> indicates the whole molecule is deuterated. We describe these different deuterations as chemical formulae below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dspc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;d-head&#39;</span><span class="p">:</span> <span class="s1">&#39;C10D18NO8P&#39;</span><span class="p">,</span> <span class="s1">&#39;d-tail&#39;</span><span class="p">:</span> <span class="s1">&#39;C34D70&#39;</span><span class="p">,</span>
        <span class="s1">&#39;h-head&#39;</span><span class="p">:</span> <span class="s1">&#39;C10H18NO8P&#39;</span><span class="p">,</span> <span class="s1">&#39;h-tail&#39;</span><span class="p">:</span> <span class="s1">&#39;C34H70&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<p>The solvent contrast is indicated as either D2O or ACMW (air-contrast matched water).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d2o</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">sld</span><span class="o">=</span><span class="mf">6.36</span><span class="p">,</span> <span class="n">isld</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D2O&#39;</span><span class="p">)</span>
<span class="n">acmw</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">sld</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">isld</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ACMW&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>All of the contrasts are at the air/water interface, so we also need an <code class="docutils literal notranslate"><span class="pre">air</span></code> material.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">air</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">sld</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">isld</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Air&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Then we can create all of the traditional layers that we will need.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d2o_layer</span> <span class="o">=</span> <span class="n">Layer</span><span class="p">(</span><span class="n">material</span><span class="o">=</span><span class="n">d2o</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">roughness</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D2O Subphase&#39;</span><span class="p">)</span>
<span class="n">acmw_layer</span> <span class="o">=</span> <span class="n">Layer</span><span class="p">(</span><span class="n">material</span><span class="o">=</span><span class="n">acmw</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">roughness</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D2O Subphase&#39;</span><span class="p">)</span>
<span class="n">air_layer</span> <span class="o">=</span> <span class="n">Layer</span><span class="p">(</span><span class="n">material</span><span class="o">=</span><span class="n">air</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">roughness</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Air Superphase&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The different isotopic contrasts of <code class="docutils literal notranslate"><span class="pre">SurfactantLayer</span></code> objects can also be created (all with the same structural parameters).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">head_thickness</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">tail_thickness</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">head_solvent_fraction</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">tail_solvent_fraction</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">area_per_molecule</span> <span class="o">=</span> <span class="mi">45</span>
<span class="n">roughness</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">'d13DSPC-D2O'</span></code> surfactant layer</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tail_layer_d13d2o</span> <span class="o">=</span> <span class="n">LayerAreaPerMolecule</span><span class="p">(</span>
    <span class="n">molecular_formula</span><span class="o">=</span><span class="n">dspc</span><span class="p">[</span><span class="s1">&#39;h-tail&#39;</span><span class="p">],</span>
    <span class="n">thickness</span><span class="o">=</span><span class="n">tail_thickness</span><span class="p">,</span>
    <span class="n">solvent</span><span class="o">=</span><span class="n">air</span><span class="p">,</span>
    <span class="n">solvent_fraction</span><span class="o">=</span><span class="n">tail_solvent_fraction</span><span class="p">,</span>
    <span class="n">area_per_molecule</span><span class="o">=</span><span class="n">area_per_molecule</span><span class="p">,</span>
    <span class="n">roughness</span><span class="o">=</span><span class="n">roughness</span>
<span class="p">)</span>
<span class="n">head_layer_d13d2o</span> <span class="o">=</span> <span class="n">LayerAreaPerMolecule</span><span class="p">(</span>
    <span class="n">molecular_formula</span><span class="o">=</span><span class="n">dspc</span><span class="p">[</span><span class="s1">&#39;d-head&#39;</span><span class="p">],</span>
    <span class="n">thickness</span><span class="o">=</span><span class="n">head_thickness</span><span class="p">,</span>
    <span class="n">solvent</span><span class="o">=</span><span class="n">d2o</span><span class="p">,</span>
    <span class="n">solvent_fraction</span><span class="o">=</span><span class="n">head_solvent_fraction</span><span class="p">,</span>
    <span class="n">area_per_molecule</span><span class="o">=</span><span class="n">area_per_molecule</span><span class="p">,</span>
    <span class="n">roughness</span><span class="o">=</span><span class="n">roughness</span>
<span class="p">)</span>
<span class="n">d13d2o</span> <span class="o">=</span> <span class="n">SurfactantLayer</span><span class="p">(</span>
    <span class="n">tail_layer</span><span class="o">=</span><span class="n">tail_layer_d13d2o</span><span class="p">,</span>
    <span class="n">head_layer</span><span class="o">=</span><span class="n">head_layer_d13d2o</span>
<span class="p">)</span>
<span class="n">d13d2o</span><span class="o">.</span><span class="n">constrain_area_per_molecule</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">d13d2o</span><span class="o">.</span><span class="n">conformal_roughness</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">d13d2o</span><span class="o">.</span><span class="n">constrain_solvent_roughness</span><span class="p">(</span><span class="n">d2o_layer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">'d70DSPC-D2O'</span></code> surfactant layer</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tail_layer_d70d2o</span> <span class="o">=</span> <span class="n">LayerAreaPerMolecule</span><span class="p">(</span>
    <span class="n">molecular_formula</span><span class="o">=</span><span class="n">dspc</span><span class="p">[</span><span class="s1">&#39;d-tail&#39;</span><span class="p">],</span>
    <span class="n">thickness</span><span class="o">=</span><span class="n">tail_thickness</span><span class="p">,</span>
    <span class="n">solvent</span><span class="o">=</span><span class="n">air</span><span class="p">,</span>
    <span class="n">solvent_fraction</span><span class="o">=</span><span class="n">tail_solvent_fraction</span><span class="p">,</span>
    <span class="n">area_per_molecule</span><span class="o">=</span><span class="n">area_per_molecule</span><span class="p">,</span>
    <span class="n">roughness</span><span class="o">=</span><span class="n">roughness</span>
<span class="p">)</span>
<span class="n">head_layer_d70d2o</span> <span class="o">=</span> <span class="n">LayerAreaPerMolecule</span><span class="p">(</span>
    <span class="n">molecular_formula</span><span class="o">=</span><span class="n">dspc</span><span class="p">[</span><span class="s1">&#39;h-head&#39;</span><span class="p">],</span>
    <span class="n">thickness</span><span class="o">=</span><span class="n">head_thickness</span><span class="p">,</span>
    <span class="n">solvent</span><span class="o">=</span><span class="n">d2o</span><span class="p">,</span>
    <span class="n">solvent_fraction</span><span class="o">=</span><span class="n">head_solvent_fraction</span><span class="p">,</span>
    <span class="n">area_per_molecule</span><span class="o">=</span><span class="n">area_per_molecule</span><span class="p">,</span>
    <span class="n">roughness</span><span class="o">=</span><span class="n">roughness</span>
<span class="p">)</span>
<span class="n">d70d2o</span> <span class="o">=</span> <span class="n">SurfactantLayer</span><span class="p">(</span>
    <span class="n">tail_layer</span><span class="o">=</span><span class="n">tail_layer_d70d2o</span><span class="p">,</span>
    <span class="n">head_layer</span><span class="o">=</span><span class="n">head_layer_d70d2o</span>
<span class="p">)</span>
<span class="n">d70d2o</span><span class="o">.</span><span class="n">constrain_area_per_molecule</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">d70d2o</span><span class="o">.</span><span class="n">conformal_roughness</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">d70d2o</span><span class="o">.</span><span class="n">constrain_solvent_roughness</span><span class="p">(</span><span class="n">d2o_layer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">'d83DSPC-ACMW'</span></code> surfactant layer</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tail_layer_d83acmw</span> <span class="o">=</span> <span class="n">LayerAreaPerMolecule</span><span class="p">(</span>
    <span class="n">molecular_formula</span><span class="o">=</span><span class="n">dspc</span><span class="p">[</span><span class="s1">&#39;d-tail&#39;</span><span class="p">],</span>
    <span class="n">thickness</span><span class="o">=</span><span class="n">tail_thickness</span><span class="p">,</span>
    <span class="n">solvent</span><span class="o">=</span><span class="n">air</span><span class="p">,</span>
    <span class="n">solvent_fraction</span><span class="o">=</span><span class="n">tail_solvent_fraction</span><span class="p">,</span>
    <span class="n">area_per_molecule</span><span class="o">=</span><span class="n">area_per_molecule</span><span class="p">,</span>
    <span class="n">roughness</span><span class="o">=</span><span class="n">roughness</span>
<span class="p">)</span>
<span class="n">head_layer_d83acmw</span> <span class="o">=</span> <span class="n">LayerAreaPerMolecule</span><span class="p">(</span>
    <span class="n">molecular_formula</span><span class="o">=</span><span class="n">dspc</span><span class="p">[</span><span class="s1">&#39;d-head&#39;</span><span class="p">],</span>
    <span class="n">thickness</span><span class="o">=</span><span class="n">head_thickness</span><span class="p">,</span>
    <span class="n">solvent</span><span class="o">=</span><span class="n">acmw</span><span class="p">,</span>
    <span class="n">solvent_fraction</span><span class="o">=</span><span class="n">head_solvent_fraction</span><span class="p">,</span>
    <span class="n">area_per_molecule</span><span class="o">=</span><span class="n">area_per_molecule</span><span class="p">,</span>
    <span class="n">roughness</span><span class="o">=</span><span class="n">roughness</span>
<span class="p">)</span>
<span class="n">d83acmw</span> <span class="o">=</span> <span class="n">SurfactantLayer</span><span class="p">(</span>
    <span class="n">tail_layer</span><span class="o">=</span><span class="n">tail_layer_d83acmw</span><span class="p">,</span>
    <span class="n">head_layer</span><span class="o">=</span><span class="n">head_layer_d83acmw</span>
<span class="p">)</span>
<span class="n">d83acmw</span><span class="o">.</span><span class="n">constrain_area_per_molecule</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">d83acmw</span><span class="o">.</span><span class="n">conformal_roughness</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">d83acmw</span><span class="o">.</span><span class="n">constrain_solvent_roughness</span><span class="p">(</span><span class="n">acmw_layer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Introducing-constraints">
<h2>Introducing constraints<a class="headerlink" href="#Introducing-constraints" title="Link to this heading">#</a></h2>
<p>Then to ensure that the structure (thicknesss, area per molecule, etc.) is kept the same between the different contrasts we constain these (<code class="docutils literal notranslate"><span class="pre">layer2</span></code> is the head layer and <code class="docutils literal notranslate"><span class="pre">layer1</span></code>, which the neutron are incident on first are the tail layer). The <code class="docutils literal notranslate"><span class="pre">constrain_multiple_contrast</span></code> method allows this, not that is it important that a chain of constraints is produced, one constraining the next.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># These four lines should be removed in future</span>
<span class="n">d70d2o</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">area_per_molecule_parameter</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">d70d2o</span><span class="o">.</span><span class="n">tail_layer</span><span class="o">.</span><span class="n">area_per_molecule_parameter</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">d83acmw</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">area_per_molecule_parameter</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">d83acmw</span><span class="o">.</span><span class="n">tail_layer</span><span class="o">.</span><span class="n">area_per_molecule_parameter</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">d70d2o</span><span class="o">.</span><span class="n">constain_multiple_contrast</span><span class="p">(</span><span class="n">d13d2o</span><span class="p">)</span>
<span class="n">d83acmw</span><span class="o">.</span><span class="n">constain_multiple_contrast</span><span class="p">(</span><span class="n">d70d2o</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can check this constraint as worked as follows.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d13d2o</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">thickness</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">d70d2o</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">thickness</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">d83acmw</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">thickness</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d13d2o</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">thickness</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d13d2o</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">thickness</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">d70d2o</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">thickness</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">d83acmw</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">thickness</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
</div>
<p>Even through only as single value (that for the d13-DSPC head thickness) was changed, all three values changed.</p>
<p>Having constructed each of the surfactant layer object and implemented the constraints, we can now build Samples and models.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resolution_function</span> <span class="o">=</span> <span class="n">PercentageFhwm</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">d13d2o_sample</span> <span class="o">=</span> <span class="n">Sample</span><span class="p">(</span><span class="n">Multilayer</span><span class="p">(</span><span class="n">air_layer</span><span class="p">),</span> <span class="n">d13d2o</span><span class="p">,</span> <span class="n">Multilayer</span><span class="p">(</span><span class="n">d2o_layer</span><span class="p">))</span>
<span class="n">d70d2o_sample</span> <span class="o">=</span> <span class="n">Sample</span><span class="p">(</span><span class="n">Multilayer</span><span class="p">(</span><span class="n">air_layer</span><span class="p">),</span> <span class="n">d70d2o</span><span class="p">,</span> <span class="n">Multilayer</span><span class="p">(</span><span class="n">d2o_layer</span><span class="p">))</span>
<span class="n">d83acmw_sample</span> <span class="o">=</span> <span class="n">Sample</span><span class="p">(</span><span class="n">Multilayer</span><span class="p">(</span><span class="n">air_layer</span><span class="p">),</span> <span class="n">d83acmw</span><span class="p">,</span> <span class="n">Multilayer</span><span class="p">(</span><span class="n">acmw_layer</span><span class="p">))</span>
<span class="n">d13d2o_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
    <span class="n">sample</span><span class="o">=</span><span class="n">d13d2o_sample</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">background</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="s1">&#39;R_d13DSPC-D2O&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
    <span class="n">resolution_function</span><span class="o">=</span><span class="n">resolution_function</span>
<span class="p">)</span>
<span class="n">d70d2o_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
    <span class="n">sample</span><span class="o">=</span><span class="n">d70d2o_sample</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">background</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="s1">&#39;R_d70DSPC-D2O&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
    <span class="n">resolution_function</span><span class="o">=</span><span class="n">resolution_function</span>
<span class="p">)</span>
<span class="n">d83acmw_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
    <span class="n">sample</span><span class="o">=</span><span class="n">d83acmw_sample</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">background</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="s1">&#39;R_d83DSPC-ACMW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
    <span class="n">resolution_function</span><span class="o">=</span><span class="n">resolution_function</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Setting-varying-parameters">
<h2>Setting varying parameters<a class="headerlink" href="#Setting-varying-parameters" title="Link to this heading">#</a></h2>
<p>For this analysis, we want the scale and background for each model to vary and then some of the structural parameters. Since the structural parameters are constrained, we only need to define the bounds once. In the case on the <code class="docutils literal notranslate"><span class="pre">d13d2o</span></code> object, as this is the basis for the constraints.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d13d2o_model</span><span class="o">.</span><span class="n">scale</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">d13d2o_model</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4e-8</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">)</span>
<span class="n">d70d2o_model</span><span class="o">.</span><span class="n">scale</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">d70d2o_model</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4e-8</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">)</span>
<span class="n">d83acmw_model</span><span class="o">.</span><span class="n">scale</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">d83acmw_model</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4e-8</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">)</span>

<span class="n">d13d2o</span><span class="o">.</span><span class="n">tail_layer</span><span class="o">.</span><span class="n">area_per_molecule_parameter</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">d13d2o</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">solvent_fraction_parameter</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">d13d2o</span><span class="o">.</span><span class="n">tail_layer</span><span class="o">.</span><span class="n">thickness</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="n">d13d2o</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">thickness</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Creating-interfaces-and-performing-the-fitting">
<h2>Creating interfaces and performing the fitting<a class="headerlink" href="#Creating-interfaces-and-performing-the-fitting" title="Link to this heading">#</a></h2>
<p>The model has been created and the parameters defined, so the fitting process can begin. First, we should create a unique interface for each of the models.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d13d2o_model</span><span class="o">.</span><span class="n">interface</span> <span class="o">=</span> <span class="n">CalculatorFactory</span><span class="p">()</span>
<span class="n">d70d2o_model</span><span class="o">.</span><span class="n">interface</span> <span class="o">=</span> <span class="n">CalculatorFactory</span><span class="p">()</span>
<span class="n">d83acmw_model</span><span class="o">.</span><span class="n">interface</span> <span class="o">=</span> <span class="n">CalculatorFactory</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The models and the interface fit functions are then passed to the <code class="docutils literal notranslate"><span class="pre">Fitter</span></code> object, which is capable of performed the multiple dataset fitting process.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fitter</span> <span class="o">=</span> <span class="n">Fitter</span><span class="p">(</span><span class="n">d13d2o_model</span><span class="p">,</span> <span class="n">d70d2o_model</span><span class="p">,</span> <span class="n">d83acmw_model</span><span class="p">)</span>
<span class="n">fitter</span><span class="o">.</span><span class="n">switch_minimizer</span><span class="p">(</span><span class="n">AvailableMinimizers</span><span class="o">.</span><span class="n">LMFit_scipy_least_squares</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analysed</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Once the fitting is complete, we can probe a given value to check that the constraints have been respected or plot the results.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d13d2o</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">area_per_molecule</span><span class="p">,</span> <span class="n">d70d2o</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">area_per_molecule</span><span class="p">,</span> <span class="n">d83acmw</span><span class="o">.</span><span class="n">head_layer</span><span class="o">.</span><span class="n">area_per_molecule</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">analysed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="monolayer.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Investigation of a surfactant monolayer</p>
      </div>
    </a>
    <a class="right-next"
       href="resolution_functions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Resolution functions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Reading-in-the-experimental-data">Reading in the experimental data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Building-our-models">Building our models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Introducing-constraints">Introducing constraints</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Setting-varying-parameters">Setting varying parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Creating-interfaces-and-performing-the-fitting">Creating interfaces and performing the fitting</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By EasyReflectometry
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, EasyReflectometry.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>